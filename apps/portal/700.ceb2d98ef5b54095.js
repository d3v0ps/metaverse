(self.webpackChunk_central_factory_portal=self.webpackChunk_central_factory_portal||[]).push([[700],{8700:(w,v,r)=>{r.r(v),r.d(v,{SelectAvatarModule:()=>T});var o=r(1457),u=r(4438),t=r(7777);let p=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=t.\u0275\u0275defineInjector({imports:[[o.CommonModule,u.O]]}),e})();var i=r(428),C=r(1375),A=r(1135),S=r(3900),g=r(4128),s=r(8505);let h=(()=>{class e{constructor(a){this.entityManager=a,this.avatars$=new A.X([]),this.entityManager.initialize$.pipe((0,S.w)(()=>(0,g.D)([this.entityManager.getRepository("useravatars","com.central-factory.user-avatars")])),(0,s.b)(([c])=>{this.userAvatarsRepository=c,this.subscribeToDataChanges()})).subscribe()}subscribeToDataChanges(){if(!this.userAvatarsRepository)throw new Error("Repositories not initialized");this.userAvatarsRepository.observe().pipe((0,s.b)(a=>this.avatars$.next(a))).subscribe()}}return e.\u0275fac=function(a){return new(a||e)(t.\u0275\u0275inject(C.v2))},e.\u0275prov=t.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var y=r(7165),m=r(1623),d=r(3454),M=r(7967);function x(e,n){if(1&e){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",2),t.\u0275\u0275listener("click",function(){const f=t.\u0275\u0275restoreView(a).$implicit;return t.\u0275\u0275nextContext().avatarClick.emit(f)}),t.\u0275\u0275element(2,"img",3),t.\u0275\u0275element(3,"br"),t.\u0275\u0275elementStart(4,"h4",4),t.\u0275\u0275text(5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()}if(2&e){const a=n.$implicit;t.\u0275\u0275advance(2),t.\u0275\u0275property("src",a.selectedAppearance.smallPreviewUrl,t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(3),t.\u0275\u0275textInterpolate(a.name)}}let E=(()=>{class e{constructor(){this.avatars=[],this.avatarClick=new t.EventEmitter}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["cf-avatars-carousel"]],inputs:{avatars:"avatars"},outputs:{avatarClick:"avatarClick"},decls:2,vars:1,consts:[["cfBlock","avatars-carousel"],[4,"ngFor","ngForOf"],["cfBlock","avatars-carousel-item",3,"click"],["cfElem","image",3,"src"],["cfElem","name"]],template:function(a,c){1&a&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275template(1,x,6,2,"ng-container",1),t.\u0275\u0275elementEnd()),2&a&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",c.avatars))},directives:[m.G,o.NgForOf,d.e],encapsulation:2}),e})();function I(e,n){1&e&&(t.\u0275\u0275elementStart(0,"h2",7),t.\u0275\u0275text(1," Select an Avatar "),t.\u0275\u0275elementEnd())}function _(e,n){if(1&e){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",8),t.\u0275\u0275elementStart(1,"cf-avatars-carousel",9),t.\u0275\u0275listener("avatarClick",function(l){return t.\u0275\u0275restoreView(a),t.\u0275\u0275nextContext(2).onAvatarClick(l)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd()}if(2&e){const a=t.\u0275\u0275nextContext().ngIf;t.\u0275\u0275advance(1),t.\u0275\u0275property("avatars",a.avatars)}}const b=function(){return["primary","big"]};function j(e,n){if(1&e){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",1),t.\u0275\u0275elementStart(2,"div",2),t.\u0275\u0275template(3,I,2,0,"h2",3),t.\u0275\u0275template(4,_,2,1,"div",4),t.\u0275\u0275elementStart(5,"div",5),t.\u0275\u0275elementStart(6,"button",6),t.\u0275\u0275listener("click",function(){return t.\u0275\u0275restoreView(a),t.\u0275\u0275nextContext().onCreateAvatarClick()}),t.\u0275\u0275text(7," Create a new Avatar "),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementContainerEnd()}if(2&e){const a=n.ngIf;t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",a.avatars&&a.avatars.length>0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",a.avatars&&a.avatars.length>0),t.\u0275\u0275advance(2),t.\u0275\u0275property("cfMod",t.\u0275\u0275pureFunction0(3,b))}}const k=function(e){return{avatars:e}},F=[{path:"",component:(()=>{class e{constructor(a,c,l){this.router=a,this.selectedAvatarState=c,this.availableAvatarsState=l,this.avatars$=this.availableAvatarsState.avatars$}onAvatarClick(a){this.selectedAvatarState.selectAvatar(a).pipe((0,s.b)(()=>this.router.navigate(["/play"]))).subscribe()}onCreateAvatarClick(){this.router.navigate(["/create-avatar"])}}return e.\u0275fac=function(a){return new(a||e)(t.\u0275\u0275directiveInject(i.Router),t.\u0275\u0275directiveInject(y.Y),t.\u0275\u0275directiveInject(h))},e.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["cf-select-avatar"]],decls:2,vars:5,consts:[[4,"ngIf"],["cfBlock","scene-content"],["cfBlock","select-avatar"],["cfElem","title",4,"ngIf"],["cfElem","avatars-carousel",4,"ngIf"],["cfElem","create-avatar"],["cfBlock","button",3,"cfMod","click"],["cfElem","title"],["cfElem","avatars-carousel"],[3,"avatars","avatarClick"]],template:function(a,c){1&a&&(t.\u0275\u0275template(0,j,8,4,"ng-container",0),t.\u0275\u0275pipe(1,"async")),2&a&&t.\u0275\u0275property("ngIf",t.\u0275\u0275pureFunction1(3,k,t.\u0275\u0275pipeBind1(1,1,c.avatars$)))},directives:[o.NgIf,m.G,d.e,M.I,E],pipes:[o.AsyncPipe],encapsulation:2}),e})()}];let R=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=t.\u0275\u0275defineInjector({imports:[[i.RouterModule.forChild(F)],i.RouterModule]}),e})(),T=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=t.\u0275\u0275defineInjector({imports:[[o.CommonModule,u.O,p,R]]}),e})()}}]);